import{r as a,a as R}from"./react-ppAWL3zK.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();var S={exports:{}},m={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C=a,T=Symbol.for("react.element"),O=Symbol.for("react.fragment"),P=Object.prototype.hasOwnProperty,E=C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,L={key:!0,ref:!0,__self:!0,__source:!0};function w(t,r,s){var o,i={},n=null,l=null;s!==void 0&&(n=""+s),r.key!==void 0&&(n=""+r.key),r.ref!==void 0&&(l=r.ref);for(o in r)P.call(r,o)&&!L.hasOwnProperty(o)&&(i[o]=r[o]);if(t&&t.defaultProps)for(o in r=t.defaultProps,r)i[o]===void 0&&(i[o]=r[o]);return{$$typeof:T,type:t,key:n,ref:l,props:i,_owner:E.current}}m.Fragment=O;m.jsx=w;m.jsxs=w;S.exports=m;var e=S.exports,k,v=R;k=v.createRoot,v.hydrateRoot;const g="https://mutiny-api.mutinycomm.workers.dev",x={async login(t,r){if(!(await fetch(`${g}/auth/login`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,password:r})})).ok)throw new Error("Login failed");return!0},async logout(){await fetch(`${g}/auth/logout`,{method:"POST",credentials:"include"})},async getMessages(t,r=50){const s=await fetch(`${g}/revolt/channels/${t}/messages?limit=${r}`,{credentials:"include"});if(!s.ok)throw new Error("Load failed");return s.json()},async sendMessage(t,r){const s=await fetch(`${g}/revolt/channels/${t}/messages`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:r})});if(!s.ok)throw new Error("Send failed");return s.json()},async react(t,r,s,o=!0){const i=`${g}/revolt/channels/${t}/messages/${r}/reactions/${encodeURIComponent(s)}`;if(!(await fetch(i,{method:o?"PUT":"DELETE",credentials:"include",body:o?"{}":void 0})).ok)throw new Error("Reaction failed");return!0},async uploadAttachment(t){const r=new FormData;r.append("file",t);const s=await fetch(`${g}/revolt/upload/attachments`,{method:"POST",credentials:"include",body:r});if(!s.ok)throw new Error("Upload failed");return s.json()}},b={async search(t="",r=""){const s=new URL(`${g}/registry/plugins`);return t&&s.searchParams.set("q",t),r&&s.searchParams.set("category",r),(await fetch(s,{credentials:"include"})).json()},async installed(){return(await fetch(`${g}/plugins/installed`,{credentials:"include"})).json()},async install(t){await fetch(`${g}/plugins/install`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})})},async uninstall(t){await fetch(`${g}/plugins/uninstall`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})})},async submit(t){return(await fetch(`${g}/registry/submit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({manifest_url:t})})).json()}};function _(){const[t,r]=a.useState([]),[s,o]=a.useState(""),[i,n]=a.useState(""),[l,h]=a.useState(""),[f,u]=a.useState(!1);async function p(){const d=await b.search(s,i);r(d.items||[])}a.useEffect(()=>{p()},[]);async function j(){l.trim()&&(u(!0),await b.submit(l.trim()),h(""),u(!1),alert("Submitted! An admin must approve it before it appears."))}async function c(d){u(!0),await b.install(d),u(!1),alert("Installed.")}async function y(d){u(!0),await b.uninstall(d),u(!1),alert("Uninstalled.")}return e.jsxs("div",{style:{padding:16},children:[e.jsx("h2",{style:{marginTop:0},children:"Plugin Store"}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:[e.jsx("input",{placeholder:"Search",value:s,onChange:d=>o(d.target.value),style:{padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"}}),e.jsxs("select",{value:i,onChange:d=>n(d.target.value),style:{padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"},children:[e.jsx("option",{value:"",children:"All categories"}),e.jsx("option",{value:"overlay",children:"Overlay"}),e.jsx("option",{value:"scheduling",children:"Scheduling"}),e.jsx("option",{value:"chat",children:"Chat"}),e.jsx("option",{value:"analytics",children:"Analytics"}),e.jsx("option",{value:"misc",children:"Misc"})]}),e.jsx("button",{onClick:p,style:{padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"},children:"Search"})]}),e.jsxs("div",{style:{border:"1px solid #23262e",borderRadius:16,padding:12,marginBottom:16},children:[e.jsx("b",{children:"Submit plugin"}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("input",{placeholder:"https://.../mutiny-plugin.json",value:l,onChange:d=>h(d.target.value),style:{flex:1,padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"}}),e.jsx("button",{onClick:j,disabled:f,style:{padding:"8px 10px",borderRadius:10,background:"#5b6eff",border:"1px solid #7785ff",color:"#fff"},children:f?"Submittingâ€¦":"Submit"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(260px,1fr))",gap:12},children:t.map(d=>e.jsxs("div",{style:{border:"1px solid #23262e",borderRadius:16,padding:12},children:[e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[d.icon&&e.jsx("img",{src:d.icon,alt:"",width:"28",height:"28",style:{borderRadius:6}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700},children:d.name}),e.jsxs("div",{style:{opacity:.7,fontSize:12},children:[d.id," Â· v",d.version]})]})]}),e.jsx("div",{style:{marginTop:8,opacity:.8,fontSize:12},children:d.categories?.join(" Â· ")||"misc"}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:10},children:[e.jsx("button",{onClick:()=>c(d.id),style:{padding:"6px 10px",borderRadius:10,background:"#1f2937",border:"1px solid #334155",color:"#fff"},children:"Install"}),e.jsx("button",{onClick:()=>y(d.id),style:{padding:"6px 10px",borderRadius:10,background:"#251b1b",border:"1px solid #442",color:"#f88"},children:"Uninstall"})]})]},d.id))})]})}function $({onOk:t}){const[r,s]=a.useState(""),[o,i]=a.useState(""),[n,l]=a.useState(null),[h,f]=a.useState(!1);async function u(){try{f(!0),l(null),await x.login(r,o),t()}catch(p){l(p.message||"Login failed")}finally{f(!1)}}return e.jsx("div",{style:{display:"grid",placeItems:"center",height:"100vh"},children:e.jsxs("div",{style:{width:380,background:"#111318",border:"1px solid #23262e",borderRadius:16,padding:24},children:[e.jsx("h2",{style:{margin:0},children:"Sign in to Mutiny"}),e.jsx("p",{style:{opacity:.7,fontSize:12},children:"Uses your Revolt account (secure cookie)."}),e.jsx("input",{placeholder:"Email or username",value:r,onChange:p=>s(p.target.value),style:{width:"100%",padding:10,marginTop:12,borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"}}),e.jsx("input",{type:"password",placeholder:"Password",value:o,onChange:p=>i(p.target.value),onKeyDown:p=>p.key==="Enter"&&u(),style:{width:"100%",padding:10,marginTop:8,borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"}}),n&&e.jsx("div",{style:{color:"#f66",fontSize:13,marginTop:8},children:n}),e.jsx("button",{onClick:u,disabled:h,style:{marginTop:12,width:"100%",padding:10,borderRadius:10,background:"#5b6eff",border:"1px solid #7785ff",color:"#fff"},children:h?"Signing inâ€¦":"Sign in"})]})})}function I({channel:t,onChannelChange:r}){const[s,o]=a.useState([]),[i,n]=a.useState(""),[l,h]=a.useState(!1);async function f(){if(t){h(!0);try{o(await x.getMessages(t,50))}finally{h(!1)}}}async function u(){!i.trim()||!t||(await x.sendMessage(t,i),n(""),f())}async function p(c){await x.react(t,c,"ðŸ‘",!0),f()}async function j(c){const y=c.target.files?.[0];if(!y)return;const{id:d}=await x.uploadAttachment(y);await x.sendMessage(t,`Attachment: ${d}`),f()}return a.useEffect(()=>{t&&f()},[t]),e.jsxs("div",{style:{border:"1px solid #23262e",borderRadius:16,overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",gap:8,padding:"8px 12px",borderBottom:"1px solid #23262e"},children:[e.jsx("input",{placeholder:"Revolt Channel ID",value:t,onChange:c=>r(c.target.value),style:{flex:1,padding:8,borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"}}),e.jsx("button",{onClick:f,style:{padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"},children:l?"Loadingâ€¦":"Load"})]}),e.jsxs("div",{style:{height:280,overflowY:"auto",padding:12},children:[s.map(c=>e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("div",{style:{fontSize:12,opacity:.7},children:c.author}),e.jsx("div",{children:c.content}),e.jsx("button",{onClick:()=>p(c._id),style:{marginTop:4,padding:"4px 6px",borderRadius:8,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"},children:"ðŸ‘ React"})]},c._id)),!s.length&&e.jsx("div",{style:{opacity:.6},children:"No messages yet."})]}),e.jsxs("div",{style:{display:"flex",gap:8,padding:12,borderTop:"1px solid #23262e"},children:[e.jsx("input",{placeholder:"Messageâ€¦",value:i,onChange:c=>n(c.target.value),onKeyDown:c=>c.key==="Enter"&&u(),style:{flex:1,padding:10,borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"}}),e.jsx("input",{type:"file",id:"up",style:{display:"none"},onChange:j}),e.jsx("label",{htmlFor:"up",style:{padding:"10px 12px",borderRadius:10,border:"1px solid #23262e",cursor:"pointer"},children:"Attach"}),e.jsx("button",{onClick:u,style:{padding:"10px 12px",borderRadius:10,background:"#5b6eff",border:"1px solid #7785ff",color:"#fff"},children:"Send"})]})]})}function A({onOpenStore:t}){return e.jsxs("aside",{style:{width:260,borderRight:"1px solid #23262e",padding:12},children:[e.jsx("div",{style:{fontWeight:800,marginBottom:10},children:"Mutiny"}),e.jsx("button",{onClick:t,style:{width:"100%",padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"},children:"Plugin Store"}),e.jsxs("div",{style:{opacity:.7,fontSize:12,marginTop:8},children:["Overlays for OBS:",e.jsx("br",{}),e.jsx("code",{children:"/overlay-now.html?channel=<id>"})]})]})}function B(){const[t,r]=a.useState(!1),[s,o]=a.useState(""),[i,n]=a.useState(!1);return t?e.jsxs("div",{style:{display:"flex",height:"100vh",background:"#0b0c10",color:"#e7ebf0"},children:[e.jsx(A,{onOpenStore:()=>n(!0)}),e.jsxs("main",{style:{flex:1,display:"flex",flexDirection:"column"},children:[e.jsxs("header",{style:{display:"flex",alignItems:"center",gap:12,padding:"10px 16px",borderBottom:"1px solid #23262e"},children:[e.jsx("b",{children:"Mutiny â€” Channel-Weaver"}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[e.jsx("button",{onClick:()=>n(!0),style:{padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"},children:"Plugins"}),e.jsx("button",{onClick:()=>{x.logout().then(()=>location.reload())},style:{padding:"8px 10px",borderRadius:10,background:"#0b0c10",border:"1px solid #23262e",color:"#e7ebf0"},children:"Logout"})]})]}),e.jsx("div",{style:{flex:1,overflowY:"auto"},children:e.jsxs("div",{style:{maxWidth:1140,margin:"0 auto",padding:16},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16},children:[e.jsxs("div",{style:{border:"1px solid #23262e",borderRadius:16,padding:16},children:[e.jsx("b",{children:"Stage (Queue â†’ Backstage â†’ On-Air)"}),e.jsx("div",{style:{opacity:.7,fontSize:12},children:"Drag/drop & hotkeys coming."})]}),e.jsxs("div",{style:{border:"1px solid #23262e",borderRadius:16,padding:16},children:[e.jsx("b",{children:"Scheduler"}),e.jsx("div",{style:{opacity:.7,fontSize:12},children:"Overlay reads the current block from backend."})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16,marginTop:16},children:[e.jsx(I,{channel:s,onChannelChange:o}),e.jsxs("div",{style:{border:"1px solid #23262e",borderRadius:16,padding:16},children:[e.jsx("b",{children:"Live Tips"}),e.jsxs("div",{style:{opacity:.7,fontSize:12,marginTop:6},children:["In OBS add a Browser Source pointing to:",e.jsx("br",{}),e.jsx("code",{children:"/overlay-now.html?channel=<your-id>"})]})]})]})]})})]}),i&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,.5)"},onClick:()=>n(!1),children:e.jsx("div",{onClick:l=>l.stopPropagation(),style:{position:"absolute",top:"8%",left:"50%",transform:"translateX(-50%)",width:900,maxWidth:"92%",background:"#111318",border:"1px solid #23262e",borderRadius:16},children:e.jsx(_,{})})})]}):e.jsx($,{onOk:()=>r(!0)})}k(document.getElementById("root")).render(e.jsx(B,{}));
